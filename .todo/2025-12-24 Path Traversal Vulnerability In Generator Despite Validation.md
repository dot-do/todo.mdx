---
id: todo-hd4v
title: "Path traversal vulnerability in generator despite validation"
state: open
priority: 1
type: bug
labels: ["code-review", "generator", "security", "src"]
createdAt: "2025-12-24T11:14:36.926Z"
updatedAt: "2025-12-24T11:14:36.926Z"
source: "beads"
---

# Path traversal vulnerability in generator despite validation

**File:** src/generator.ts:203-219, 245-256

The `validatePathSafety` function is called AFTER `fs.mkdir` creates the directory:

```typescript
// Line 250-256
const fileDir = dirname(filepath)
if (fileDir !== todoDir) {
  await fs.mkdir(fileDir, { recursive: true })  // Directory created FIRST
}

// Security: Validate that the resolved path is within the target directory
validatePathSafety(filepath, todoDir)  // Validation AFTER mkdir
```

If an issue's title contains path traversal characters that slip through the pattern system, malicious directories could be created before validation rejects the path.

**Impact:** Potential directory creation outside the intended target directory.

**Recommendation:** Move `validatePathSafety()` call BEFORE `fs.mkdir()` and validate both the file path and the directory path.