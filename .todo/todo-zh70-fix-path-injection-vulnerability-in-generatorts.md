---
id: todo-zh70
title: "Fix path injection vulnerability in generator.ts"
state: closed
priority: 0
type: bug
labels: ["critical", "security"]
createdAt: "2025-12-23T12:43:40.980Z"
updatedAt: "2025-12-23T12:52:58.240Z"
closedAt: "2025-12-23T12:52:58.240Z"
source: "beads"
---

# Fix path injection vulnerability in generator.ts

**Security Issue**: `writeTodoFiles` accepts `todoDir` parameter without validation. Malicious input could write files anywhere on the filesystem.

**Location**: `src/generator.ts` lines 203-222

**Fix**:
- Resolve todoDir to absolute path
- Validate it's within current working directory
- Reject paths that start with `..` or are absolute

**Test Cases**:
- Should reject `../malicious` path
- Should reject `/etc/passwd` absolute path
- Should accept `.todo` and `issues` relative paths
- Should accept nested paths like `docs/todo`

### Timeline

- **Created:** 12/23/2025
- **Updated:** 12/23/2025
- **Closed:** 12/23/2025
