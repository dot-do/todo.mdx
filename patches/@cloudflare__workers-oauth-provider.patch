diff --git a/dist/oauth-provider.js b/dist/oauth-provider.js
index 026c6768bfd32145cf68f77db72d3cc88c89a149..7390c56bf98a722645c69ade97eb017925be63a7 100644
--- a/dist/oauth-provider.js
+++ b/dist/oauth-provider.js
@@ -1014,7 +1014,7 @@ var OAuthProviderImpl = class {
       }
       if (tokenData.audience) {
         const requestUrl = new URL(request.url);
-        const resourceServer = `${requestUrl.protocol}//${requestUrl.host}`;
+        const resourceServer = `${requestUrl.protocol}//${requestUrl.host}${requestUrl.pathname}`;
         const audiences = Array.isArray(tokenData.audience) ? tokenData.audience : [tokenData.audience];
         const matches = audiences.some((aud) => audienceMatches(resourceServer, aud));
         if (!matches) {
@@ -1035,7 +1035,7 @@ var OAuthProviderImpl = class {
       }
       if (ext.audience) {
         const requestUrl = new URL(request.url);
-        const resourceServer = `${requestUrl.protocol}//${requestUrl.host}`;
+        const resourceServer = `${requestUrl.protocol}//${requestUrl.host}${requestUrl.pathname}`;
         const audiences = Array.isArray(ext.audience) ? ext.audience : [ext.audience];
         const matches = audiences.some((aud) => audienceMatches(resourceServer, aud));
         if (!matches) {
@@ -1141,7 +1141,22 @@ function validateResourceUri(uri) {
   }
 }
 function audienceMatches(resourceServerUrl, audienceValue) {
-  return resourceServerUrl === audienceValue;
+  if (resourceServerUrl === audienceValue) {
+    return true;
+  }
+  try {
+    const resourceUrl = new URL(resourceServerUrl);
+    const audienceUrl = new URL(audienceValue);
+    if (resourceUrl.origin !== audienceUrl.origin) {
+      return false;
+    }
+    if (audienceUrl.pathname === "/" || audienceUrl.pathname === "") {
+      return true;
+    }
+    return resourceUrl.pathname === audienceUrl.pathname || resourceUrl.pathname.startsWith(audienceUrl.pathname + "/");
+  } catch {
+    return false;
+  }
 }
 function parseResourceParameter(value) {
   if (!value) {
